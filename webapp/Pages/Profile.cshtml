@page
@model webapp.Pages.ProfileModel
@{
	ViewData["Title"] = "Profile";
}
<h2>@ViewData["Title"]</h2>
<h3>@ViewData["Message"]</h3>

<form>
	<p>
		UPN: <input type="text" asp-for="SearchString" />
		<input type="submit" value="Submit" />
	</p>
</form>
<table class="table table-striped table-condensed" style="font-family: monospace">
	<tr>
		<th>Property</th>
		<th>Value</th>
	</tr>

	@{
		if (Model.GraphUser != null)
		{
			<tr>
				<td>photo</td>
				<td>
					@{
						if (!string.IsNullOrEmpty(Model.Photo))
						{
							<img style="margin: 5px 0; width: 150px" src="data:image/jpeg;base64, @Model.Photo" />
						}
						else
						{
							<h3>NO PHOTO</h3>
							<p>Check user profile in Azure Active Directory to add a photo.</p>
						}
					}
				</td>
			</tr>

			<tr>
				<td> Display name </td>
				<td> @Html.DisplayFor(model => model.GraphUser.DisplayName) </td>
			</tr>
			<tr>
				<td> Mail </td>
				<td> @Html.DisplayFor(model => model.GraphUser.Mail) </td>
			</tr>
			<tr>
				<td> UPN </td>
				<td> @Html.DisplayFor(model => model.GraphUser.UserPrincipalName) </td>
			</tr>
		}
	}
</table>